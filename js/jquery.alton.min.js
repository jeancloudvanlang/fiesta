/* ===============================================================================
 * alton.js v1.2.0
 * ===============================================================================
 * Copyright 2014 Paper Leaf Design
 * http://www.paper-leaf.com
 *
 * Author: Paper Leaf
 *
 * A full featured scrolling plugin for creating
 * immersive featured sections or headers.
 *
 * Credit:
 * is_mobile() based off these helpful posts
 * - http://stackoverflow.com/questions/3514784/what-is-the-best-way-to-detect-a-handheld-device-in-jquery
 *
 * Getting stable scroll events was helped hugely by Huge Inc's insights
 * - http://www.hugeinc.com/ideas/perspective/scroll-jacking-on-hugeinc
 *
 * Stabilizing keypress events was helped in large part by jQuery OnePage Scroll
 * - https://github.com/peachananr/onepage-scroll
 *
 * License: GPL v3
 * =============================================================================== */
 !function(e){"use strict";var t={firstClass:"header",fullSlideContainer:"full",singleSlideClass:"slide",nextElement:"div",previousClass:null,lastClass:"footer",slideNumbersContainer:"slide-numbers",bodyContainer:"pageWrapper",scrollMode:"featuredScroll",useSlideNumbers:!1,slideNumbersBorderColor:"#fff",slideNumbersColor:"#000",animationType:"slow"};e.fn.alton=function(s){function o(t){if("featuredScroll"===t){for(N=p.length-1;N>=0;N-=1)r()&&e(p[N]).height()>O?e(p[N]).css("height",e(p[N]).height()):(e(p[N]).css("height",O),e(p[N]).outerHeight(O));if(S.useSlideNumbers&&!r()){e("."+S.bodyContainer).append('<div id="'+S.slideNumbersContainer+'"></div>'),e("#"+S.slideNumbersContainer).css({height:"100%",position:"fixed",top:0,right:"0px",bottom:"0px",width:"86px","z-index":999}),r()&&e("#"+S.slideNumbersContainer).css({height:"auto","min-height":"100%"}),e("."+S.bodyContainer+" #"+S.slideNumbersContainer).append("<ul></ul>"),e("."+S.bodyContainer+" #"+S.slideNumbersContainer+" ul").css({transform:"translateY(-50%)","-moz-transform":"translateY(-50%)","-ms-transform":"translateY(-50%)","-o-transform":"translateY(-50%)","-webkit-transform":"translateY(-50%)",top:"50%",position:"fixed"});for(var s=0;E>s;)e("."+S.bodyContainer+" #"+S.slideNumbersContainer+" ul").append('<li class="paginate"></ul>'),e(".paginate").css(l()?{cursor:"pointer","border-radius":"50%","list-style":"none",background:S.slideNumbersBorderColor,"border-color":S.slideNumbersBorderColor,"border-width":"2px","border-style":"solid",height:"11px",width:"11px",margin:"5px 0"}:{cursor:"pointer","border-radius":"50%","list-style":"none",background:S.slideNumbersBorderColor,"border-color":S.slideNumbersBorderColor,"border-width":"2px","border-style":"solid",height:"10px",width:"10px",margin:"5px 0"}),s+=1;C="getElementsByClassName"in document?document.getElementsByClassName("paginate"):document.querySelectorAll(".paginate")}}else e("."+S.firstClass).css("height",O+10),e("."+S.firstClass).hasClass("active")||(e("."+S.firstClass).toggleClass("active"),l()&&e(".paginate.active").css({"margin-left":"-1px","border-color":"#"+S.slideNumbersBorderColor,"border-style":"solid","border-width":"2px",height:"8px",width:"8px"}))}function l(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");return t>0||navigator.userAgent.match(/Trident.*rv\:11\./)?!0:!1}function r(){return navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|BB10|Windows Phone|Tizen|Bada)/)}function n(t,s){s&&e(C[e(t).parent().children().index(t)]).hasClass("active")?(e(C[e(t).parent().children().index(t)]).toggleClass("active"),e(C[e(t).parent().children().index(t)]).css("background",S.slideNumbersBorderColor)):e(C[e(t).parent().children().index(t)]).hasClass("active")||(e(C[e(t).parent().children().index(t)]).toggleClass("active"),e(C[e(t).parent().children().index(t)]).css("background",S.slideNumbersColor))}function i(t){S.useSlideNumbers&&(t?e("#"+S.slideNumbersContainer).fadeIn():e("#"+S.slideNumbersContainer).fadeOut())}function a(t){var s=document.getElementsByClassName(x);e(document).scrollTo(e(s[t])),g=s[t],k=e(g).prev().hasClass(x)?e(g).prev():e("."+S.firstClass),D=e(g).next().hasClass(x)?e(g).next():e("."+S.lastClass),n(e("#"+S.slideNumbersContainer+" li.active"),!0),n(s[t],!1)}function d(){(e(D).length>0||e(k).length>0)&&(e(window).scrollTop()>=e("."+x+":first").offset().top&&e(window).scrollTop()+e(window).outerHeight()!==e(document).outerHeight()?(S.useSlideNumbers&&n(g,!0),e("."+x).each(function(){w=e(this).offset().top,w<=e(window).scrollTop()&&(k=e(this).prev().hasClass(x)?e(this).prev():e("."+S.firstClass),g=e(this),D=g.next().hasClass(x)?e(this).next():e("."+S.lastClass),M=!1)}),S.useSlideNumbers&&n(g,!1),e(document).scrollTo(g)):(S.useSlideNumbers&&(B!==e("."+x+":last-child")[0]?i(!1):(i(!0),n(g,!1))),e(document).scrollTo(g)))}function u(e){void 0!=e&&(e=e||window.event,e.preventDefault&&(e.stopPropagation(),e.returnValue=!1))}function c(e){return u(e)}function m(){return window.pageYOffset||P.scrollTop}function f(t){return b=e("body,html").is(":animated")||e("body").is(":animated")||e("html").is(":animated"),"mousewheel"==t.type||"DOMMouseScroll"==t.type?(clearTimeout(e.data(this,"scrollTimer")),e(document).unbind({scroll:f}),e.data(this,"scrollTimer",setTimeout(function(){Y=!1,e(document).bind({scroll:f})},35)),t.originalEvent.detail>1&&!Y||t.originalEvent.wheelDelta<-1&&!Y?(A+=1,e(document).moveDown(),Y=!0,u()):(t.originalEvent.detail<-1&&!Y||t.originalEvent.wheelDelta>1&&!Y)&&(H+=1,e(document).moveUp(),Y=!0,u())):"scroll"==t.type&&(u(),Y=!1,clearTimeout(e.data(this,"scrollTimer")),e.data(this,"scrollTimer",setTimeout(function(){d()},500))),!1}function h(t){if(v=m(),t.originalEvent.detail>0||t.originalEvent.wheelDelta<0){if(!(e(D).offset().top>0&&v<e("."+S.firstClass).outerHeight()))return!0;if(e("."+S.firstClass).hasClass("active"))return e("."+S.firstClass).toggleClass("active"),e(document).scrollTo(D),k=g,g=D,c(t);if(!e("html, body").is(":animated"))return!0}else if(!e("."+S.firstClass).hasClass("active")&&e(window).scrollTop()<=e("."+S.firstClass).outerHeight())e("."+S.firstClass).toggleClass("active"),e(document).scrollTo(k),D=g,g=k;else if(!e("html, body").is(":animated"))return!0;return!1}var p,b,g,C,v,w,N,S=e.extend(!0,{},t,s),x=S.singleSlideClass,y=!1,T=!1,D=e("."+x+":first"),k=null,B=e("."+S.lastClass),E=e("."+S.fullSlideContainer).children().length,M=!0,H=0,A=0,O=e(window).outerHeight(),Y=!1,P=window.document.documentElement;p="getElementsByClassName"in document?document.getElementsByClassName(x):document.querySelectorAll("."+x),e("."+S.firstClass).length>0?g=e("."+S.firstClass):(k=null,g=D,D=g.next(),B=e("."+x+":last-child")[0]),"headerScroll"===S.scrollMode&&(g=e("."+S.firstClass),D=e("."+S.bodyContainer+":first")),e.fn.moveDown=function(){v=m(),v>=0&&v<=e(g).scrollTop()&&M===!0?(k=g,g=D,D=g.next(),S.useSlideNumbers&&(B===e("."+x+":last-child")[0]?(n(k,!0),n(g,!1)):(n(g,!1),i(!0))),M=!1,e(document).scrollTo(g)):!b&&D&&e(g).offset().top<v+1&&(D.hasClass(x)?(k=g,g=D,D=e(g).next(),S.useSlideNumbers&&(n(k,!0),n(g,!1)),e(document).scrollTo(g)):B!==e("."+x+":last-child")[0]&&(k=e("."+x+":last-child")[0],g=B,D=null,e(window).scrollTop()+O+10>=e(document).outerHeight()-e(B).outerHeight()&&S.useSlideNumbers&&(n(k,!1),i(!1)),e(document).scrollTo(g),e.event.trigger({type:"lastSlide",slide:B,time:new Date})))},e.fn.moveUp=function(){v=m(),e("."+S.fullSlideContainer).offset().top+1>v&&k&&v>0?(e(g).offset().top>=v?(g=e("."+S.firstClass),k=null,D=e("."+x),S.useSlideNumbers&&(i(!1),n(D,!1)),M=!0):(g=k,k=null,D=e("."+x),S.useSlideNumbers&&(n(g,!0),n(k,!0))),e(document).scrollTo(g)):!b&&e("."+S.fullSlideContainer).offset().top<v&&(g=k,k=e(g).prev(),D=e(g).next(),S.useSlideNumbers&&(n(g,!1),n(D,!0),i(!0)),e(document).scrollTo(g)),T=!0,y=!1},e.fn.scrollTo=function(t){t!==B?e("body,html").stop(!0,!0).animate({scrollTop:e(t).offset().top},{duration:375}):e("body,html").stop(!0,!0).animate({scrollTop:e(document).outerHeight()-O},{duration:375})},e(document).ready(function(){if(o(S.scrollMode),"featuredScroll"!==S.scrollMode||r()||d(),"featuredScroll"===S.scrollMode&&!r()){e("#"+S.slideNumbersContainer+" li").on("click",function(){a(e(this).parent().children().index(this))});var t=[];onkeydown=onkeyup=function(s){switch(s=s||event,t[s.which]="keyup"==s.type,s.which){case 40:s.preventDefault(),e(document).moveDown(s);break;case 32:s.preventDefault(),1==t[16]?e(document).moveUp(s):e(document).moveDown(s);break;case 33:e(document).moveDown(s),s.preventDefault();break;case 34:s.preventDefault(),e(document).moveUp(s);break;case 38:s.preventDefault(),e(document).moveUp(s);break;case 36:s.preventDefault(),0!==e("."+S.firstClass).length?(S.useSlideNumbers&&n(g,!0),k=null,g="."+S.firstClass,D=e("."+x+":first"),S.useSlideNumbers&&n(g,!1),e(document).scrollTo("."+S.firstClass)):(S.useSlideNumbers&&n(g,!0),k=null,g=e(".pane:first"),D=g.next(),e(document).scrollTo(e(".pane")[0]),S.useSlideNumbers&&n(g,!1));break;case 35:0!==e("."+S.firstClass).length?(S.useSlideNumbers&&(n(e(g),!0),n(e(".pane:last"),!1)),k=e(".pane:last")):(S.useSlideNumbers&&(n(e(g),!0),n(e(B),!1)),k=e(B).prev()),g=e(B),D=null,s.preventDefault(),e(document).scrollTo(B);break;default:s.preventDefault()}}}r()||("featuredScroll"===S.scrollMode?e(document).bind({"DOMMouseScroll mousewheel scroll":f}):"headerScroll"===S.scrollMode&&e(document).bind({"DOMMouseScroll mousewheel":h}),e(window).resize(function(){e(p).each(function(){e(this).css("height",e(window).outerHeight()),e(this).outerHeight(e(window).outerHeight())})}))})}}(jQuery);
